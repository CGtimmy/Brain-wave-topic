data = load('/Users/hoyi/Downloads/0708何翊/20240708162218_test_bleEXGdata.mat');
data = data_struct.data;
data = double(data);
data = data';
% 提取訊號1和信號2數據
cz_signal = data(:, 1); 
fz_signal = data(:, 2); 

fs = 250;
window = hamming(256);
noverlap = 128; 
nfft = 512; 

% 計算CZ信號的STFT
[cz_s, cz_f, cz_t, cz_p] = spectrogram(cz_signal, window, noverlap, nfft, fs, 'yaxis');
% 計算FZ信號的STFT
[fz_s, fz_f, fz_t, fz_p] = spectrogram(fz_signal, window, noverlap, nfft, fs, 'yaxis');

% 繪製CZ頻譜圖
figure;
subplot(2,1,1);
surf(cz_t/60, cz_f, 10*log10(abs(cz_p)), 'EdgeColor', 'none');
axis tight;
ylim([0 60]);
view(0, 90);
colorbar;
title('CZ Spectrogram');
xlabel('Time (minutes)');
ylabel('Frequency (Hz)');
caxis([-10 20]);
colormap(jet);

% 繪製FZ頻譜圖
subplot(2,1,2);
surf(fz_t/60, fz_f, 10*log10(abs(fz_p)), 'EdgeColor', 'none');
axis tight;
ylim([0 60]);
view(0, 90);
colorbar;
title('FZ Spectrogram');
xlabel('Time (minutes)');
ylabel('Frequency (Hz)');
caxis([-10 20]);
colormap(jet);
